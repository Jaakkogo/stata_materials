
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Some motivation and more Stata commands &#8212; ECON-C4X00</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://jaakkogo.github.io/stata_materials/second_touch.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="More bysort, merge and multivariate regression using Stata" href="third_touch.html" />
    <link rel="prev" title="Importing data and statistical functions" href="first_touch.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://jaakkogo.github.io/stata_materials/second_touch.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Some motivation and more Stata commands" />
<meta property="og:description" content="Some motivation and more Stata commands  egen and bysort  Next we will go through some extremely useful and Stata idiomatics commands, namely the egen and bysor" />
<meta property="og:image"       content="https://jaakkogo.github.io/stata_materials/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">ECON-C4X00</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Other_resources.html">
   External resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dynamic_documents.html">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     dyndoc
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     markstat
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stata_basics.html">
   Stata basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="first_touch.html">
   Importing data and statistical functions
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Some motivation and more Stata commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="third_touch.html">
   More
   <code class="docutils literal notranslate">
    <span class="pre">
     bysort
    </span>
   </code>
   ,
   <code class="docutils literal notranslate">
    <span class="pre">
     merge
    </span>
   </code>
   and multivariate regression using Stata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fourth_touch.html">
   Recap of random number generation and more about interactions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fifth_touch.html">
   Panel data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fifth_touch.html#combining-data-sets-introduction-to-append">
   Combining data sets - Introduction to
   <code class="docutils literal notranslate">
    <span class="pre">
     append
    </span>
   </code>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/second_touch.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/second_touch.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#egen-and-bysort">
   <code class="docutils literal notranslate">
    <span class="pre">
     egen
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     bysort
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-written-packages-egenmore-and-some-motivate">
   User written packages:
   <code class="docutils literal notranslate">
    <span class="pre">
     egenmore
    </span>
   </code>
   and some
   <code class="docutils literal notranslate">
    <span class="pre">
     motivate
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-univariate-regressions-in-stata">
   Basic univariate regressions in Stata
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-data-for-later-use">
   Save data for later use
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="some-motivation-and-more-stata-commands">
<h1>Some motivation and more Stata commands<a class="headerlink" href="#some-motivation-and-more-stata-commands" title="Permalink to this headline">¶</a></h1>
<div class="section" id="egen-and-bysort">
<h2><code class="docutils literal notranslate"><span class="pre">egen</span></code> and <code class="docutils literal notranslate"><span class="pre">bysort</span></code><a class="headerlink" href="#egen-and-bysort" title="Permalink to this headline">¶</a></h2>
<p>Next we will go through some extremely useful and Stata idiomatics commands, namely the <code class="docutils literal notranslate"><span class="pre">egen</span></code> and <code class="docutils literal notranslate"><span class="pre">bysort</span></code> commands. <code class="docutils literal notranslate"><span class="pre">egen</span></code> stands for <em>extended generate</em> and is probably the one of the most important Stata commands after <code class="docutils literal notranslate"><span class="pre">help</span></code> and <code class="docutils literal notranslate"><span class="pre">gen</span></code>.</p>
<p>Recall that in the <code class="docutils literal notranslate"><span class="pre">gen</span></code> command requires the user to assign the variable values from some existing Stata commands or by typing the valus self. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gen dummy = 0
replace dummy = 1 if !missing(some_variable)

</pre></div>
</div>
<p>Or directly from the return value of the <code class="docutils literal notranslate"><span class="pre">missing</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gen dummy = !missing(some_variable)

</pre></div>
</div>
<p>It’s clearly useful to use the return values from known Stata functions if possible. But where to find useful Stata functions?</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Strictly speaking Stata functions are a different thing from commands. So far I’ve used both terms when referring to stuff that you can write to the command line.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">missing</span></code> is one function we are already are familiar with. So is <code class="docutils literal notranslate"><span class="pre">strpos</span></code> or <code class="docutils literal notranslate"><span class="pre">substr</span></code> and the other <a class="reference external" href="https://www.stata.com/manuals/fnstringfunctions.pdf">string manipulation functions</a> mentioned in the previous exercise session. Other examples are <a class="reference external" href="https://www.stata.com/manuals/fnstatisticalfunctions.pdf">statistical functions</a> such as <code class="docutils literal notranslate"><span class="pre">normal(z)</span></code> that returns the cumulative probability of a given Z-value. The statistical functions are mostly functions for statistical distributions. They can also be used with the <code class="docutils literal notranslate"><span class="pre">display</span></code> command.</p>
<p>Probably more useful tricks are the various <a class="reference external" href="https://www.stata.com/manuals/fnrandom-numberfunctions.pdf">random number generators</a> that can be used for instance with simulations. More on those later.</p>
<p>Next here is a minor example that demonstrates different options for generate. I use the command <code class="docutils literal notranslate"><span class="pre">quietly</span></code> to tell Stata not to print any output for commands inside the brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">quietly</span> {
<span class="k">    clear</span>
<span class="k">    set</span> obs <span class="m">10</span>
<span class="k">    gen</span> text = <span class="s">&quot;Hello world!&quot;</span>
<span class="k">    gen</span> first_char = <span class="nf">substr</span>(text,<span class="m">1</span>,<span class="m">1</span>)
<span class="k">    gen</span> random = <span class="nf">rnormal</span>()
<span class="k">    gen</span> p = <span class="nf">normal</span>(random)
}    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>%browse
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>first_char</th>
      <th>random</th>
      <th>p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>2.0255878</td>
      <td>.97859645</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>1.0426311</td>
      <td>.85144043</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>.29771236</td>
      <td>.61703867</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>-1.7221316</td>
      <td>.04252284</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>-.72919953</td>
      <td>.23293981</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>.86182606</td>
      <td>.80560839</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>-.23935401</td>
      <td>.40541553</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>.51654899</td>
      <td>.69726449</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>-1.8120158</td>
      <td>.034991879</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Hello world!</td>
      <td>H</td>
      <td>-1.0151243</td>
      <td>.15502329</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Oftentimes we want to generate variables based on some characteristics of existing variables (data). This is where we want to use <code class="docutils literal notranslate"><span class="pre">egen</span></code>. It has various functions that can do exactly that. Let’s list a few:</p>
<ol class="simple">
<li><p>mean(expression)</p>
<ul class="simple">
<li><p>creates a constant for the mean in expression</p></li>
</ul>
</li>
<li><p>sd(expression)</p>
<ul class="simple">
<li><p>creates a constant for the standard deviation in expression</p></li>
</ul>
</li>
<li><p>max(expression)</p>
<ul class="simple">
<li><p>creates a constant for the max in expression</p></li>
</ul>
</li>
<li><p>count(expression)</p>
<ul class="simple">
<li><p>creates a constant containing the number of nonmissing observations of expression</p></li>
</ul>
</li>
</ol>
<p>The list goes on. You can view the full list of <code class="docutils literal notranslate"><span class="pre">egen</span></code> functions by typing <code class="docutils literal notranslate"><span class="pre">help</span> <span class="pre">egen</span></code> to the command line. Let’s not try the command now in action:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">qui</span>{
<span class="k">    clear</span>
<span class="k">    set</span> obs <span class="m">1000000</span>
<span class="k">    gen</span> random_var = <span class="nf">rnormal</span>()
<span class="k">    egen</span> average =<span class="k"> mean</span>(random_var)
<span class="k">    egen</span> sd = sd(random_var)  
}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>%browse <span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>random_var</th>
      <th>average</th>
      <th>sd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.0953676</td>
      <td>-.0010069405</td>
      <td>1.0000892</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.3326492</td>
      <td>-.0010069405</td>
      <td>1.0000892</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-.360688</td>
      <td>-.0010069405</td>
      <td>1.0000892</td>
    </tr>
    <tr>
      <th>4</th>
      <td>.73510557</td>
      <td>-.0010069405</td>
      <td>1.0000892</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-.96148294</td>
      <td>-.0010069405</td>
      <td>1.0000892</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The real power of <code class="docutils literal notranslate"><span class="pre">egen</span></code> comes for the possibility to use some of the funtions with <code class="docutils literal notranslate"><span class="pre">by(varlist)</span></code>. This is a way to execute Stata commands separately for some groups of observations.</p>
<p>The best way to demostrate this is by an example. Let’s continue working with our data from Sweden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">cd</span> Z:<span class="o">/</span>ECON<span class="o">-</span>C4100 <span class="c1">// change working dir</span>
<span class="k">use</span> data<span class="o">/</span>sweden_prices_raw<span class="m">.</span>dta,<span class="k"> clear</span>
<span class="k">describe</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z:\ECON-C4100
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Contains data from data/sweden_prices_raw.dta
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  obs:        14,015                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> vars:            17                          5 Mar 2021 19:54
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> size:     6,559,020                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              storage   display    value
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variable name   type    format     label      variable label
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Produktnamn     str50   %50s                  Produktnamn
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Varunummer      str6    %9s                   Varunummer
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ATCkod          str16   %16s                  ATC-kod
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NPLid           str14   %14s                  NPL id
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NPLpackid       str14   %14s                  NPL pack-id
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Form            str86   %86s                  Form
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Styrka          str43   %43s                  Styrka
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Förpackning     str142  %142s                 Förpackning
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Antal           str9    %9s                   Antal
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Företag         str49   %49s                  Företag
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AIP             double  %10.0g                AIP
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AUP             double  %10.0g                AUP
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AIPperst        double  %10.0g                AIP per st
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AUPperst        double  %10.0g                AUP per st
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Subventionerad  str2    %9s                   Subventionerad
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dummy           float   %9.0g                 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>atc_1           str1    %9s                   
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sorted by: 
</pre></div>
</div>
</div>
</div>
<p>In this example, we calculate the conditional expectation for prices of <a class="reference external" href="https://www.whocc.no/atc/structure_and_principles/">the anatomical main groups in our data</a> and for products whose pharmacy purchasing price is more than 1000 kronor. More specifically, we calculate</p>
<p><span class="math notranslate nohighlight">\(E(ppp \;| \;ATC_1, \;ppp &gt; 1000)\)</span></p>
<p>Steps:</p>
<ol class="simple">
<li><p>Extract the 1st level from the ATC variable</p></li>
<li><p>use <code class="docutils literal notranslate"><span class="pre">egen</span></code> with <code class="docutils literal notranslate"><span class="pre">by</span></code> and <code class="docutils literal notranslate"><span class="pre">cond</span></code></p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">cond</span></code> is a regular (and a very useful function!).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">bysort</span> atc_1:<span class="k"> egen</span> cond_mean =<span class="k"> mean</span>(<span class="nf">cond</span>(AIP<span class="o">&gt;</span> <span class="m">1000</span>, AIP, .))<span class="k"></span>
<span class="k">tab</span> cond_mean
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  cond_mean |      Freq.     Percent        Cum.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1993.099 |        546        3.90        3.90
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2327.616 |        410        2.93        6.82
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2714.376 |      4,421       31.54       38.37
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3240.064 |         46        0.33       38.69
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3508.171 |        123        0.88       39.57
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   5963.415 |      1,418       10.12       49.69
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   6490.541 |        404        2.88       52.57
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   7943.088 |        349        2.49       55.06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8051.962 |        403        2.88       57.94
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8418.336 |        961        6.86       64.79
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   10760.64 |      1,428       10.19       74.98
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   13138.13 |      1,036        7.39       82.38
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   14979.36 |      1,771       12.64       95.01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   17128.51 |        699        4.99      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Total |     14,015      100.00
</pre></div>
</div>
</div>
</div>
<p>There’s also a simpler way to do the same thing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">bysort</span> atc_1:<span class="k"> egen</span> cond_mean_2 =<span class="k"> mean</span>(AIP)<span class="k"> if</span> AIP <span class="o">&gt;</span> <span class="m">1000</span><span class="k"></span>
<span class="k">tab</span> cond_mean_2
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10309 missing values generated)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cond_mean_2 |      Freq.     Percent        Cum.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1993.099 |        126        3.40        3.40
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2327.616 |         33        0.89        4.29
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2714.376 |        538       14.52       18.81
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3240.064 |         10        0.27       19.08
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3508.171 |         84        2.27       21.34
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   5963.415 |        258        6.96       28.31
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   6490.541 |        182        4.91       33.22
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   7943.088 |          5        0.13       33.35
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8051.962 |         60        1.62       34.97
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8418.336 |        564       15.22       50.19
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   10760.64 |         90        2.43       52.62
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   13138.13 |        324        8.74       61.36
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   14979.36 |      1,307       35.27       96.63
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   17128.51 |        125        3.37      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Total |      3,706      100.00
</pre></div>
</div>
</div>
</div>
<p>However, notice that now the expectation is saved only for those observations that satisfy the condition.</p>
<p>It’s also worthwile to note that we can do <code class="docutils literal notranslate"><span class="pre">by</span></code> with several different notations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">by</span> atc_1,<span class="k"> sort</span>:<span class="k"> egen</span> cond_mean_3 =<span class="k"> mean</span>(<span class="nf">cond</span>(AIP<span class="o">&gt;</span> <span class="m">1000</span>, AIP, .))<span class="k"></span>
<span class="k">egen</span> cond_mean_4 =<span class="k"> mean</span>(<span class="nf">cond</span>(AIP<span class="o">&gt;</span> <span class="m">1000</span>, AIP, .)),<span class="k"> by</span>(atc_1)<span class="k"></span>
<span class="k">tab</span> cond_mean_3<span class="k"></span>
<span class="k">tab</span> cond_mean_4<span class="k"></span>
<span class="k">drop</span> cond_mean<span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cond_mean_3 |      Freq.     Percent        Cum.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1993.099 |        546        3.90        3.90
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2327.616 |        410        2.93        6.82
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2714.376 |      4,421       31.54       38.37
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3240.064 |         46        0.33       38.69
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3508.171 |        123        0.88       39.57
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   5963.415 |      1,418       10.12       49.69
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   6490.541 |        404        2.88       52.57
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   7943.088 |        349        2.49       55.06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8051.962 |        403        2.88       57.94
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8418.336 |        961        6.86       64.79
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   10760.64 |      1,428       10.19       74.98
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   13138.13 |      1,036        7.39       82.38
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   14979.36 |      1,771       12.64       95.01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   17128.51 |        699        4.99      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Total |     14,015      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cond_mean_4 |      Freq.     Percent        Cum.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1993.099 |        546        3.90        3.90
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2327.616 |        410        2.93        6.82
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2714.376 |      4,421       31.54       38.37
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3240.064 |         46        0.33       38.69
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   3508.171 |        123        0.88       39.57
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   5963.415 |      1,418       10.12       49.69
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   6490.541 |        404        2.88       52.57
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   7943.088 |        349        2.49       55.06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8051.962 |        403        2.88       57.94
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   8418.336 |        961        6.86       64.79
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   10760.64 |      1,428       10.19       74.98
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   13138.13 |      1,036        7.39       82.38
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   14979.36 |      1,771       12.64       95.01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   17128.51 |        699        4.99      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Total |     14,015      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="user-written-packages-egenmore-and-some-motivate">
<h2>User written packages: <code class="docutils literal notranslate"><span class="pre">egenmore</span></code> and some <code class="docutils literal notranslate"><span class="pre">motivate</span></code><a class="headerlink" href="#user-written-packages-egenmore-and-some-motivate" title="Permalink to this headline">¶</a></h2>
<p>Stata is a completely programmable language. While it is possible to create your own functions, most of the time some one else has already done the work for you. The Stata community has produced many used userwritten packages that you can download directly into Stata with the <code class="docutils literal notranslate"><span class="pre">ssc</span></code> or <code class="docutils literal notranslate"><span class="pre">net</span></code> command, depending where the program is published. The best of the best packages from the Stata community are published in <a class="reference external" href="https://www.stata-journal.com/">the Stata Journal</a>. One of the giants of the community, <a class="reference external" href="https://www.statalist.org/forums/member/6-nick-cox">Nick Cox</a>, is responsible for several of these commands.</p>
<p>The most downloaded packages can be printed with the following command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">ssc</span> hot
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Top 10 packages at SSC
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Jan 2021   
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Rank   # hits    Package       Author(s)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ----------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     1  193218.0    outreg2       Roy Wada                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     2  87706.3    ritest        Simon Hess                              
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     3  42149.8    estout        Ben Jann                                
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     4  24481.3    asdoc         Attaullah Shah                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     5  20767.3    winsor2       Lian Yu-jun                             
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     6  13653.7    filelist      Robert Picard                           
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     7  11351.7    reghdfe       Sergio Correia                          
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     8  11131.3    unique        Tony Brady                              
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     9  10946.3    ivreg2        Mark E Schaffer, Steven Stillman,       
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                   Christopher F Baum                      
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    10  10886.2    ivreg210      Mark E Schaffer, Christopher F Baum,    
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                   Steven Stillman                         
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ----------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (Click on package name for description)
</pre></div>
</div>
</div>
</div>
<p>We will next download two user written packages into Stata which -besides their popularity- are not listed in the Dec 2020 hotlist. These commands are <code class="docutils literal notranslate"><span class="pre">motivate</span></code> and <code class="docutils literal notranslate"><span class="pre">egenmore</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssc</span> <span class="n">install</span> <span class="n">motivate</span><span class="p">,</span> <span class="n">replace</span> 
<span class="n">ssc</span> <span class="n">install</span> <span class="n">egenmore</span><span class="p">,</span> <span class="n">replace</span>

</pre></div>
</div>
<p>I’ve already installed these packages so we don’t run the <code class="docutils literal notranslate"><span class="pre">ssc</span></code> commands above. However, we can see them in action starting with the <code class="docutils literal notranslate"><span class="pre">egenmore</span></code> package that adds some functions to <code class="docutils literal notranslate"><span class="pre">egen</span></code> (there is no <code class="docutils literal notranslate"><span class="pre">egenmore</span></code> command). For example, <code class="docutils literal notranslate"><span class="pre">corr(x</span> <span class="pre">y)</span></code> can be used to manually calculate OLS estimates. We won’t do it here, but you will have a similar exercise in the Problem Set 3.</p>
<p>To calculate (and save) the covariance and correlation between <code class="docutils literal notranslate"><span class="pre">AIP</span></code> and the length of the name of the product, let’s type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">qui</span> {
<span class="k">    gen</span> name_length = <span class="nf">length</span>(Produktnamn)
<span class="k">    egen</span> correlation =<span class="k"> corr</span>(AIP name_length)
<span class="k">    egen</span> covariance =<span class="k"> corr</span>(AIP name_length), covariance
}<span class="k"></span>
<span class="k">tab</span> correlation<span class="k"></span>
<span class="k">tab</span> covariance
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>. tab correlation
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correlation |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     of AIP |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name_length |      Freq.     Percent        Cum.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  -.1652212 |     14,015      100.00      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Total |     14,015      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>. tab covariance
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Covariance |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     of AIP |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name_length |      Freq.     Percent        Cum.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  -11487.42 |     14,015      100.00      100.00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------+-----------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Total |     14,015      100.00
</pre></div>
</div>
</div>
</div>
<p>Having done that, we can congratulate ourselves with the <code class="docutils literal notranslate"><span class="pre">motivate</span></code> command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>motivate
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;I find that the harder I work, the more luck I seem to have&#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                            Thomas Jefferson
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="basic-univariate-regressions-in-stata">
<h2>Basic univariate regressions in Stata<a class="headerlink" href="#basic-univariate-regressions-in-stata" title="Permalink to this headline">¶</a></h2>
<p>Doing OLS regressions in Stata is quite easy. You use the command <code class="docutils literal notranslate"><span class="pre">regress</span></code>, or <code class="docutils literal notranslate"><span class="pre">reg</span></code> in short, followed by the dependent variable and the indpendent variable(s). Let’s try the following (linear) model in stata:</p>
<p><span class="math notranslate nohighlight">\(AIP = \beta_0 + \beta_1 \times nameLength + u\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">reg</span> AIP name_length
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Source |       SS           df       MS      Number of obs   =    14,015
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-------------+----------------------------------   F(1, 14013)     =    393.26
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Model |  4.5351e+10         1  4.5351e+10   Prob &gt; F        =    0.0000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Residual |  1.6160e+12    14,013   115318937   R-squared       =    0.0273
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-------------+----------------------------------   Adj R-squared   =    0.0272
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Total |  1.6613e+12    14,014   118546806   Root MSE        =     10739
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------------------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         AIP |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-------------+----------------------------------------------------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> name_length |  -281.7079   14.20553   -19.83   0.000    -309.5526   -253.8631
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       _cons |   6502.726   205.7255    31.61   0.000     6099.477    6905.976
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>The above regression table tells that products that have longer names are less expensive in average. A decrease of one chracter in the product name’s length is in average associated with a decrease or roughly 273 kronors in Apotek Inkop Pris (the slope).</p>
<p>The table also tells us that based on our model, products whose name is zero characters long cost 6318.27 kronors to the pharmacists (the constant). Finally, the R-squared tells us that our model is able to explain roughly 2.6% of the variation of AIP in the data.</p>
</div>
<div class="section" id="save-data-for-later-use">
<h2>Save data for later use<a class="headerlink" href="#save-data-for-later-use" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">save</span> data<span class="o">/</span>sweden_prices<span class="m">.</span>dta,<span class="k"> replace</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>file data/sweden_prices.dta saved
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "stata"
        },
        kernelOptions: {
            kernelName: "stata",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'stata'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="first_touch.html" title="previous page">Importing data and statistical functions</a>
    <a class='right-next' id="next-link" href="third_touch.html" title="next page">More <code class="docutils literal notranslate"><span class="pre">bysort</span></code>, <code class="docutils literal notranslate"><span class="pre">merge</span></code> and multivariate regression using Stata</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Jaakko Markkanen<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>